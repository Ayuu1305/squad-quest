// Add this to your firestore.rules file

// Collection: feedback
// Users can create their own feedback entries
match /feedback/{feedbackId} {
  // Only authenticated users can submit feedback
  allow create: if request.auth != null
                && request.resource.data.userId == request.auth.uid
                && request.resource.data.keys().hasAll(['userId', 'userEmail', 'userName', 'type', 'message', 'city', 'status', 'createdAt'])
                && request.resource.data.type in ['bug_report', 'feature_request', 'complaint', 'safety_issue']
                && request.resource.data.status == 'pending'
                && request.resource.data.message.size() > 0
                && request.resource.data.message.size() <= 1000;
  
  // Only the feedback creator can read their own submissions
  allow read: if request.auth.uid == resource.data.userId;
  
  // No updates or deletes allowed (feedback is permanent for admin review)
  allow update, delete: if false;
}
